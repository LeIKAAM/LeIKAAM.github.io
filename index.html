<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Officiel de IKAAM</title>
    
    <link rel="icon" href="logo-removebg-preview.png" type="image/png">
    <link rel="shortcut icon" href="logo-removebg-preview.png" type="image/png">
    <link rel="apple-touch-icon" href="logo-removebg-preview.png">

    <style>
        /* --- CONFIGURATION --- */
        :root {
            --bg-main: #f5f5f7;
            --text-primary: #1d1d1f;
            --text-secondary: #86868b;
            --glass-bg: rgba(255, 255, 255, 0.75);
            --glass-border: rgba(255, 255, 255, 0.9);
            --shadow-soft: 0 15px 35px -5px rgba(0, 0, 0, 0.07);
            --radius-l: 28px;
            --radius-m: 12px;
            --accent-blue: #0071e3;
            --accent-red: #e60012;
            --discord-color: #5865F2;
            --orb-opacity: 0.5;
        }

        [data-theme="dark"] {
            --bg-main: #0d0d0d;
            --text-primary: #f5f5f7;
            --text-secondary: #a1a1a6;
            --glass-bg: rgba(30, 30, 30, 0.70);
            --glass-border: rgba(255, 255, 255, 0.1);
            --shadow-soft: 0 15px 35px -5px rgba(0, 0, 0, 0.5);
            --orb-opacity: 0.3;
        }

        body {
            background-color: var(--bg-main);
            color: var(--text-primary);
            font-family: "SF Pro Text", "SF Pro Icons", "Helvetica Neue", "Helvetica", "Arial", sans-serif;
            margin: 0; padding: 0; overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            min-height: 100vh;
            transition: background-color 0.4s ease, color 0.4s ease;
        }

        /* --- FOND ANIM√â --- */
        .ambient-light {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; 
            background: var(--bg-main); transition: background 0.4s ease;
        }
        .orb {
            position: absolute; border-radius: 50%; filter: blur(90px); opacity: var(--orb-opacity);
            animation: float 25s infinite alternate ease-in-out;
            transition: opacity 0.4s ease;
        }
        .orb-1 { top: -15%; left: -15%; width: 55vw; height: 55vw; background: radial-gradient(circle, #dceaff 0%, transparent 70%); }
        .orb-2 { bottom: -15%; right: -15%; width: 65vw; height: 65vw; background: radial-gradient(circle, #eef2ff 0%, transparent 70%); animation-delay: -7s; }
        @keyframes float { 0% { transform: translate(0, 0); } 100% { transform: translate(40px, 60px); } }

        /* --- HEADER --- */
        header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 40px; position: sticky; top: 0; z-index: 100;
            background: var(--glass-bg);
            backdrop-filter: saturate(180%) blur(20px);
            -webkit-backdrop-filter: saturate(180%) blur(20px);
            border-bottom: 1px solid var(--glass-border);
            transition: background 0.4s, border 0.4s;
        }
        
        .logo img { height: 50px; width: auto; display: block; transition: transform 0.3s ease; }
        .logo img:hover { transform: scale(1.05); }

        .header-actions { display: flex; align-items: center; gap: 12px; }

        .btn {
            padding: 10px 20px; border-radius: 99px; text-decoration: none;
            font-weight: 500; font-size: 0.9rem; transition: all 0.3s ease;
            cursor: pointer; border: none; display: flex; align-items: center; justify-content: center;
        }
        
        .theme-btn {
            background-color: rgba(128, 128, 128, 0.15); color: var(--text-primary);
            font-size: 1.2rem; padding: 8px 15px;
        }
        .theme-btn:hover { background-color: rgba(128, 128, 128, 0.3); }

        .discord-btn {
            background-color: rgba(128, 128, 128, 0.1); color: var(--text-primary);
            border: 1px solid var(--glass-border); backdrop-filter: blur(5px);
        }
        .discord-btn:hover {
            background-color: var(--discord-color); color: white; border-color: var(--discord-color);
            transform: translateY(-2px); box-shadow: 0 5px 15px rgba(88, 101, 242, 0.3);
        }
        .subscribe-btn { background-color: var(--text-primary); color: var(--bg-main); }
        .subscribe-btn:hover { transform: translateY(-2px); opacity: 0.9; box-shadow: 0 5px 15px rgba(0,0,0,0.15); }

        /* --- BREAKING NEWS BAR --- */
        .news-ticker {
            width: 100%;
            background: var(--glass-bg);
            border-bottom: 1px solid var(--glass-border);
            overflow: hidden;
            white-space: nowrap;
            position: relative;
            z-index: 90;
            height: 40px;
            display: flex;
            align-items: center;
            backdrop-filter: blur(10px);
        }
        
        .news-content {
            display: inline-block;
            padding-left: 100%;
            animation: scroll-text 45s linear infinite; 
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
        }
        
        .news-content span { margin-right: 50px; }
        .news-badge { background: var(--accent-red); color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; margin-right: 8px; }
        
        .news-ticker:hover .news-content { animation-play-state: paused; cursor: default; }

        @keyframes scroll-text {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }

        /* --- CHATBOX --- */
        .chat-container { position: relative; display: inline-block; padding-bottom: 0; }
        .chat-btn { background-color: #2ecc71; color: white; border: 1px solid rgba(0,0,0,0.05); }
        .chat-btn:hover { background-color: #27ae60; transform: translateY(-2px); }
        .chat-popup {
            display: none; position: absolute; right: -50px; top: 45px;
            width: 350px; height: 500px; background-color: white;
            border-radius: 16px; box-shadow: 0 20px 50px rgba(0,0,0,0.4);
            z-index: 2000; overflow: hidden; border: 1px solid rgba(0,0,0,0.1);
            animation: fadeIn 0.3s ease;
        }
        .chat-container:hover .chat-popup { display: block; }

        /* --- CONTENEUR --- */
        .container { max-width: 1100px; margin: 0 auto; padding: 40px 24px 80px 24px; }

        /* --- RECHERCHE --- */
        .search-container { max-width: 400px; margin: 0 auto 30px auto; position: relative; z-index: 10; }
        #searchInput {
            width: 100%; padding: 12px 20px; border-radius: 50px;
            border: 1px solid var(--glass-border); background: var(--glass-bg);
            backdrop-filter: blur(10px); font-size: 1rem; color: var(--text-primary);
            outline: none; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            box-sizing: border-box;
        }
        #searchInput:focus { transform: scale(1.02); border-color: var(--accent-blue); }

        /* --- NAVIGATION --- */
        .segmented-control {
            display: inline-flex; background: rgba(118, 118, 128, 0.12);
            padding: 4px; border-radius: 100px; margin: 0 auto 50px auto; 
            position: relative; z-index: 1; max-width: 100%;
            overflow-x: auto; white-space: nowrap; left: 50%; transform: translateX(-50%);
        }
        .segmented-control::-webkit-scrollbar { display: none; }
        .segment-bubble {
            position: absolute; top: 4px; left: 4px; height: calc(100% - 8px);
            background: var(--bg-main); border-radius: 100px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1); z-index: -1; pointer-events: none;
        }
        .segment-btn {
            border: none; background: none; padding: 8px 20px; 
            font-size: 0.95rem; font-weight: 500; color: var(--text-secondary); 
            cursor: pointer; border-radius: 100px; transition: color 0.3s ease; z-index: 2;
        }
        .segment-btn.active { font-weight: 600; color: var(--text-primary); }

        /* --- GRID --- */
        h1 { font-family: "SF Pro Display", sans-serif; font-size: 3rem; font-weight: 600; letter-spacing: -0.04em; margin-bottom: 40px; text-align: center; color: var(--text-primary); }
        .bento-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; width: 100%; }
        .span-full { grid-column: span 2; }
        .video-card.featured { grid-column: span 2; min-height: 520px; }
        .download-card { min-height: auto !important; padding: 30px !important; display: flex; flex-direction: column; justify-content: space-between; }

        /* --- CARD --- */
        .card {
            background-color: var(--glass-bg); border-radius: var(--radius-l); overflow: hidden;
            position: relative; cursor: pointer; border: 1px solid var(--glass-border); 
            box-shadow: var(--shadow-soft); transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1), box-shadow 0.4s ease, background-color 0.4s;
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            opacity: 0; animation: fadeUp 0.8s forwards; aspect-ratio: auto;
        }
        .card:hover {
            transform: translateY(-8px) scale(1.01); box-shadow: 0 30px 60px -12px rgba(0,0,0,0.25);
            z-index: 10; background-color: var(--bg-main);
        }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        /* --- ELEMENTS (CLICK TO COPY) --- */
        .dl-title { font-size: 1.8rem; font-weight: 700; margin-bottom: 10px; color: var(--text-primary); }
        .dl-desc { font-size: 1rem; color: var(--text-secondary); line-height: 1.5; margin-bottom: 20px; }
        .dl-btn { display: inline-block; background-color: var(--accent-blue); color: white; padding: 12px 24px; border-radius: 12px; text-decoration: none; font-weight: 600; text-align: center; transition: transform 0.2s; margin-top: 10px; font-size: 0.9rem; border: none; cursor: pointer; }
        .dl-btn:hover { transform: scale(1.02); filter: brightness(110%); }
        .dl-btn.secondary { background-color: #333; color: white; }
        .dl-btn.mega { background-color: #D92E2E; } 
        .dl-btn.switch-btn { background-color: var(--accent-red); }
        .dl-btn.youtube { background-color: #FF0000; width: 100%; box-sizing: border-box; }
        
        .code-block { background: rgba(128,128,128,0.1); border-radius: 12px; padding: 15px; font-family: monospace; margin-bottom: 20px; max-height: 200px; overflow-y: auto; color: var(--text-primary); border: 1px solid var(--glass-border); }
        
        .key-row { 
            display: flex; justify-content: space-between; align-items: center;
            padding: 8px 12px; margin-bottom: 6px;
            background: rgba(0,0,0,0.05); border-radius: 6px;
            cursor: pointer; transition: all 0.2s; border: 1px solid transparent;
            user-select: none;
        }
        .key-row:hover { background: rgba(0, 113, 227, 0.1); border-color: var(--accent-blue); transform: translateX(5px); }
        .key-row:active { transform: scale(0.98); }
        .copy-icon { font-size: 0.8rem; opacity: 0.5; }

        .instruction-list { padding-left: 20px; margin-bottom: 20px; color: var(--text-secondary); }
        .dl-actions { display: flex; gap: 10px; flex-wrap: wrap; margin-top: auto; }
        .server-ip { font-weight: 700; color: var(--accent-blue); display: block; margin-top: 5px; user-select: all; }
        .faq-item h4 { color: var(--text-primary); }
        .tuto-section h3, .tuto-section strong { color: var(--text-primary); }

        /* --- VIDEOS --- */
        .thumbnail-container { width: 100%; height: 100%; position: relative; overflow: hidden; border-radius: var(--radius-l) var(--radius-l) 0 0; }
        .thumbnail-container img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.6s; }
        .thumbnail-container::after { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(to bottom, transparent 50%, rgba(0,0,0,0.6) 80%, rgba(0,0,0,0.9) 100%); pointer-events: none; z-index: 1; }
        .card:hover .thumbnail-container img { transform: scale(1.05); }
        .card-content { position: absolute; bottom: 0; left: 0; right: 0; padding: 25px; z-index: 2; }
        .video-eyebrow-date { font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: rgba(255,255,255,0.8); margin-bottom: 6px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .video-title { font-family: "SF Pro Display", sans-serif; font-size: 1.4rem; font-weight: 700; margin: 0; color: #FFFFFF; text-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .video-card.featured .video-title { font-size: 2.4rem; }
        .play-icon { position: absolute; top: 20px; right: 20px; width: 45px; height: 45px; background: rgba(255,255,255,0.2); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; opacity: 0; transform: scale(0.8) translateY(10px); transition: all 0.4s; color: white; font-size: 1.2rem; }
        .card:hover .play-icon { opacity: 1; transform: scale(1) translateY(0); }

        /* --- MODALE --- */
        .modal {
            display: none; position: fixed; z-index: 99999; left: 0; top: 0;
            width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.9); backdrop-filter: blur(5px);
            justify-content: center; align-items: center; animation: fadeIn 0.3s ease;
        }
        .modal-content {
            position: relative; background-color: var(--bg-main);
            width: 80%; max-width: 900px;
            border-radius: 16px; box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            overflow: hidden;
        }
        .close-btn {
            position: absolute; top: 10px; right: 15px; color: var(--text-primary); 
            font-size: 30px; font-weight: bold; cursor: pointer; transition: color 0.3s; z-index: 10;
        }
        .close-btn:hover { color: #e60012; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- LECTEUR MUSIQUE --- */
        .music-player { position: fixed; bottom: 20px; left: 20px; z-index: 100; }
        #playBtn { background: var(--glass-bg); color: var(--text-primary); backdrop-filter: blur(10px); border: 1px solid var(--glass-border); padding: 10px 20px; border-radius: 30px; cursor: pointer; font-weight: 600; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: 0.3s; display: flex; align-items: center; gap: 8px; }

        /* --- TOAST NOTIFICATION --- */
        #toast {
            visibility: hidden; min-width: 250px; margin-left: -125px;
            background-color: #333; color: #fff; text-align: center; border-radius: 50px;
            padding: 16px; position: fixed; z-index: 100000; left: 50%; bottom: 30px;
            font-size: 17px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); backdrop-filter: blur(10px);
        }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

        .hidden { display: none !important; }

        /* =========================================
           VERSION MOBILE (COMPATIBILIT√â OPTIMALE)
           ========================================= */
        @media screen and (max-width: 850px) {

            /* 1. HEADER & NAVIGATION */
            header {
                flex-direction: column; /* Empile le logo et les boutons */
                padding: 15px 10px;
                gap: 15px;
                position: relative; 
            }

            .logo img { height: 40px; margin: 0 auto; }

            .header-actions {
                display: grid; /* Transforme les boutons en grille facile √† toucher */
                grid-template-columns: 1fr 1fr; /* 2 boutons par ligne */
                gap: 10px;
                width: 100%;
            }

            /* Le bouton S'abonner prend toute la largeur */
            .subscribe-btn { grid-column: span 2; text-align: center; }
            
            /* Boutons plus gros */
            .btn { padding: 12px; font-size: 0.9rem; justify-content: center; display: flex; }

            /* 2. MENU DES ONGLETS (SCROLLABLE) */
            .segmented-control {
                width: 100%; left: 0; transform: none; margin: 0 0 30px 0;
                display: flex; overflow-x: auto; justify-content: flex-start;
                padding: 5px 15px; -webkit-overflow-scrolling: touch; background: transparent; 
            }
            .segmented-control::-webkit-scrollbar { display: none; }
            .segment-btn { flex: 0 0 auto; margin-right: 10px; background: var(--glass-bg); border: 1px solid var(--glass-border); }

            /* 3. CORPS DE PAGE */
            .container { padding: 10px 15px 100px 15px; overflow-x: hidden; }

            h1 { font-size: 1.8rem; margin-bottom: 20px; margin-top: 10px; }

            /* Grille passe en 1 seule colonne */
            .bento-grid { display: flex; flex-direction: column; gap: 20px; }
            .card, .video-card.featured, .span-full { grid-column: auto; width: 100%; min-height: auto; }
            .card:hover { transform: none; }

            /* 4. T√âL√âCHARGEMENTS ET CL√âS */
            .download-card { padding: 20px !important; }
            .dl-actions { flex-direction: column; width: 100%; }
            .dl-btn { width: 100%; box-sizing: border-box; text-align: center; margin-bottom: 5px; }
            .code-block { overflow-x: auto; white-space: nowrap; }

            /* 5. LE CHAT */
            .chat-container { position: static; } 
            .chat-popup {
                position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                width: 90vw; height: 60vh; right: auto; border-radius: 20px;
                box-shadow: 0 0 100px rgba(0,0,0,0.5);
            }

            /* 6. MODALES */
            .modal-content { width: 95%; border-radius: 12px; }
            .close-btn { top: 10px; right: 10px; font-size: 24px; }
            .news-ticker { display: none; } 
        }
    </style>
</head>
<body>
    <div class="ambient-light"><div class="orb orb-1"></div><div class="orb orb-2"></div></div>
    
    <div id="toast">‚úÖ Action effectu√©e !</div>

    <header>
        <div class="logo">
            <img src="logo-removebg-preview.png" alt="Logo LeIKAAM">
        </div>
        <div class="header-actions">
            <button class="btn theme-btn" onclick="toggleTheme()" title="Theme">üåô</button>
            
            <button id="authBtn" class="btn" style="background:#333; color:white; border:1px solid rgba(255,255,255,0.2);" onclick="openAuthModal()">üë§ Connexion</button>

            <div class="chat-container">
                <button class="btn chat-btn">üí¨ Chat</button>
                <div class="chat-popup">
                    <iframe src="https://organizations.minnit.chat/506159263403973/c/Main?embed&nickname=" style="border:none;width:100%;height:100%;" allow="microphone; camera; autoplay; encrypted-media; fullscreen"></iframe>
                </div>
            </div>

            <a href="https://discord.gg/pwGEPyB9Jz" target="_blank" class="btn discord-btn">Discord</a>
            <a href="https://youtube.com/@LeIKAAM" target="_blank" class="btn subscribe-btn">S'abonner</a>
        </div>
    </header>

    <div class="news-ticker">
        <div class="news-content">
            <span><span class="news-badge">INFO</span>V2 du site drop !</span>
            <span><span class="news-badge">NEW</span>Citron disponible dans les √©mulateurs.</span>
            <span><span class="news-badge">JEUX</span>Tous les Call of Duty PC sont dispo.</span>
            <span><span class="news-badge">SOON</span>La prochaine vid√©o est en cours de montage</span>
        </div>
    </div>

    <div class="container">
        
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Rechercher un jeu, un tuto..." onkeyup="filterCards()">
        </div>

        <div class="segmented-control">
            <div class="segment-bubble"></div>
            <button id="nav-videos" class="segment-btn active" onclick="switchTab('videos')">Vid√©os</button>
            <button id="nav-cod" class="segment-btn" onclick="switchTab('cod')">Call of Duty</button>
            <button id="nav-switch" class="segment-btn" onclick="switchTab('switch')">Switch</button>
            <button id="nav-emulators" class="segment-btn" onclick="switchTab('emulators')">√âmulateurs</button>
            <button id="nav-forum" class="segment-btn" onclick="switchTab('forum')">Forum</button>
        </div>

        <div id="tab-videos">
            <h1>Derni√®res Vid√©os</h1>
            <div class="bento-grid" id="video-grid"></div>
        </div>

        <div id="tab-cod" class="hidden">
            <h1>Call of Duty</h1>
            <div class="bento-grid">
                <div class="card download-card span-full">
                    <div><div class="video-eyebrow-date">Classique</div><div class="dl-title">Call of Duty 1X</div><p class="dl-desc">La version revisit√©e du premier opus. Extrait simplement le fichier RAR et lance le jeu.</p></div>
                    <a href="https://www.mediafire.com/file/34lt06fw6ad1t64/COD1X.rar" target="_blank" class="dl-btn">T√©l√©charger (Mediafire)</a>
                </div>
                <div class="card download-card span-full">
                    <div><div class="video-eyebrow-date">L√©gendaire</div><div class="dl-title">Call of Duty 2</div><p class="dl-desc">Extrait le jeu et lance-le. Clique sur une cl√© pour copier :</p>
                        <div class="code-block">
                            <span class="key-row" onclick="copyKey(this)">XEZL-GZWX-XQZG-GEGU-EEFC <span class="copy-icon">üìã</span></span>
                            <span class="key-row" onclick="copyKey(this)">W5HA-3557-666Q-JQGZ-232E <span class="copy-icon">üìã</span></span>
                            <span class="key-row" onclick="copyKey(this)">W5HA-ZHEL-666Q-L66X-CD23 <span class="copy-icon">üìã</span></span>
                            <span class="key-row" onclick="copyKey(this)">W55E-QE6E-66Q6-EWE6-76DD <span class="copy-icon">üìã</span></span>
                        </div>
                    </div>
                    <a href="https://www.mediafire.com/file/iydrzjoi7m0fahn/COD2.rar" target="_blank" class="dl-btn">T√©l√©charger le Jeu</a>
                </div>
                <div class="card download-card">
                    <div><div class="video-eyebrow-date">Moderne</div><div class="dl-title">Call of Duty 4X</div><div class="dl-actions"><a href="https://www.mediafire.com/file/498gner89hj16mc/COD4.zip" target="_blank" class="dl-btn">1. Jeu</a><a href="https://cod4promod.eu/files/cod4/cod4x_client_21_1.zip" target="_blank" class="dl-btn secondary">2. Patch</a></div></div>
                </div>
            </div>
        </div>

        <div id="tab-switch" class="hidden">
            <h1>Nintendo Switch</h1>
            <div class="bento-grid">
                <div class="card download-card span-full">
                    <div><div class="video-eyebrow-date">Pack AIO</div><div class="dl-title">Pack pour Hack la Switch</div><ul class="instruction-list"><li>Supprimer tout de la carte SD <strong>SAUF</strong> Nintendo, emuMMC.</li><li>Mettre tout le contenu du ZIP √† la racine.</li></ul></div>
                    <a href="https://cdn.discordapp.com/attachments/960788243308232704/1441453401954058302/Pack_Switch.zip" target="_blank" class="dl-btn switch-btn">T√©l√©charger le Pack Switch</a>
                </div>
            </div>
        </div>

        <div id="tab-emulators" class="hidden">
            <h1>√âmulateurs</h1>
            <div class="bento-grid">
                <div class="card download-card span-full">
                    <div><div class="video-eyebrow-date">Nintendo Switch</div><div class="dl-title">Citron</div><p class="dl-desc">Le nouvel √©mulateur Switch performant.</p></div>
                    <div class="dl-actions">
                        <a href="https://citron-emu.org/" target="_blank" class="dl-btn" style="background-color: #F4D03F; color: black;">T√©l√©charger Citron</a>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-forum" class="hidden">
            <h1>Communaut√© IKAAM</h1>
            
            <div id="forum-list-view">
                <div class="card download-card span-full" style="margin-bottom: 20px;">
                    <h3 style="margin-top:0;">Cr√©er un nouveau sujet</h3>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <input type="text" id="newTopicTitle" placeholder="Titre de votre sujet..." style="flex-grow: 1; padding: 10px; border-radius: 8px; border: 1px solid var(--glass-border); background: var(--bg-main); color: var(--text-primary);">
                        <button onclick="createNewTopic()" class="dl-btn" style="margin:0; cursor:pointer;">Publier</button>
                    </div>
                </div>
                <div id="topics-container" class="bento-grid">
                    <p style="color:var(--text-secondary); padding: 20px;">Chargement des discussions...</p>
                </div>
            </div>

            <div id="forum-topic-view" class="hidden">
                <button onclick="backToForum()" class="btn" style="margin-bottom:20px; background:var(--glass-bg); color:var(--text-primary);">‚Üê Retour</button>
                
                <div id="current-topic-header" class="card span-full" style="padding:20px; margin-bottom:20px; cursor:default;">
                    </div>
                
                <div id="replies-container" style="display:flex; flex-direction:column; gap:15px; margin-bottom: 30px;">
                    </div>
                
                <div class="card span-full" style="padding:20px;">
                    <textarea id="replyInput" placeholder="Participer √† la discussion..." rows="3" style="width:100%; padding:10px; border-radius:8px; border:1px solid var(--glass-border); background:var(--bg-main); color:var(--text-primary); margin-bottom:10px; resize: none;"></textarea>
                    <button onclick="sendReply()" class="dl-btn" style="width:100%;">Envoyer la r√©ponse</button>
                </div>
            </div>
        </div>

    </div>

    <footer><p style="color: #86868b; text-align:center; padding: 20px;">Copyright ¬© 2026 IKAAM Inc.</p></footer>

    <div id="videoModal" class="modal">
        <div class="modal-content" style="aspect-ratio: 16/9;">
            <span class="close-btn" onclick="document.getElementById('videoModal').style.display='none'">&times;</span>
            <iframe id="videoFrame" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="width:100%; height:100%;"></iframe>
        </div>
    </div>

    <div id="authModal" class="modal">
        <div class="modal-content" style="max-width:350px; padding:30px; text-align:center; height:auto; background: #1c1c1e; border: 1px solid rgba(255,255,255,0.1);">
            <span class="close-btn" onclick="document.getElementById('authModal').style.display='none'">&times;</span>
            <h2 id="authTitle" style="color:white; margin-top:0;">Connexion</h2>
            
            <input type="email" id="email" placeholder="Email" style="width:100%; padding:12px; margin:10px 0; border-radius:8px; border:none; background: #2c2c2e; color: white;">
            <input type="password" id="password" placeholder="Mot de passe" style="width:100%; padding:12px; margin:10px 0; border-radius:8px; border:none; background: #2c2c2e; color: white;">
            
            <button onclick="handleAuth()" class="dl-btn" style="width:100%; margin-top:10px;">Valider</button>
            
            <p onclick="toggleAuthMode()" style="color:#aaa; cursor:pointer; margin-top:15px; font-size: 0.9rem;">Pas de compte ? <span style="color:var(--accent-blue); text-decoration: underline;">Cr√©er un compte</span></p>
            <p id="authMsg" style="color:#ff453a; margin-top:10px; font-size: 0.85rem;"></p>
        </div>
    </div>

    <div class="music-player">
        <button id="playBtn" onclick="toggleMusic()">üéµ Play Music</button>
        <audio id="bgMusic" loop crossorigin="anonymous">
            <source src="https://stream.zeno.fm/0r0xa854rp8uv" type="audio/mpeg">
        </audio>
    </div>

    <script>
        // --- SCRIPT STANDARD ---
        const CHANNEL_ID = 'UCBUHEV2NI3H4weKFG4Fz7AQ'; 
        const grid = document.getElementById('video-grid');
        const modal = document.getElementById("videoModal");
        const videoFrame = document.getElementById("videoFrame");

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute("data-theme");
            const newTheme = currentTheme === "dark" ? "light" : "dark";
            document.documentElement.setAttribute("data-theme", newTheme);
            localStorage.setItem("theme", newTheme);
            document.querySelector('.theme-btn').innerText = newTheme === "dark" ? "‚òÄÔ∏è" : "üåô";
        }
        const savedTheme = localStorage.getItem("theme");
        if(savedTheme) {
            document.documentElement.setAttribute("data-theme", savedTheme);
            document.querySelector('.theme-btn').innerText = savedTheme === "dark" ? "‚òÄÔ∏è" : "üåô";
        }

        function copyKey(element) {
            const key = element.childNodes[0].textContent.trim();
            navigator.clipboard.writeText(key).then(() => showToast(`‚úÖ Cl√© copi√©e : ${key}`));
        }

        function showToast(message) {
            const toast = document.getElementById("toast");
            toast.innerText = message;
            toast.className = "show";
            setTimeout(function(){ toast.className = toast.className.replace("show", ""); }, 3000);
        }

        var music = document.getElementById("bgMusic");
        var btn = document.getElementById("playBtn");
        var isPlaying = false;
        function toggleMusic() {
            if (isPlaying) { music.pause(); btn.innerText = "üéµ Play Music"; } 
            else { music.play().catch(e => console.log(e)); btn.innerText = "‚è∏ Pause Music"; }
            isPlaying = !isPlaying;
        }

        function filterCards() {
            let input = document.getElementById('searchInput');
            let filter = input.value.toUpperCase();
            let cards = document.querySelectorAll('.card'); 
            let tabs = ['videos', 'cod', 'switch', 'emulators', 'forum'];
            let headers = document.querySelectorAll('h1');

            if (filter.length > 0) {
                tabs.forEach(t => { let tabDiv = document.getElementById('tab-' + t); if(tabDiv) tabDiv.classList.remove('hidden'); });
                headers.forEach(h => h.style.display = 'none');
                cards.forEach(card => {
                    let text = card.textContent || card.innerText;
                    if (text.toUpperCase().indexOf(filter) > -1) card.style.display = ""; else card.style.display = "none";
                });
            } else {
                headers.forEach(h => h.style.display = '');
                cards.forEach(card => card.style.display = "");
                const activeBtn = document.querySelector('.segment-btn.active');
                if(activeBtn) switchTab(activeBtn.id.replace('nav-', ''));
            }
        }

        function openModal(videoId) { modal.style.display = "flex"; videoFrame.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`; }
        window.onclick = function(event) { if (event.target == modal) { modal.style.display = "none"; videoFrame.src = ""; } }

        async function fetchYouTubeVideos() {
            try {
                const res = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=https://www.youtube.com/feeds/videos.xml?channel_id=${CHANNEL_ID}`);
                const data = await res.json();
                if (!data.items) return;
                grid.innerHTML = '';
                data.items.forEach((item, index) => {
                    const videoId = item.link.split('v=')[1];
                    const card = document.createElement('div');
                    card.className = index === 0 ? 'card video-card featured' : 'card video-card';
                    card.onclick = () => openModal(videoId);
                    card.innerHTML = `
                        <div class="thumbnail-container">
                            <img src="https://i.ytimg.com/vi/${videoId}/maxresdefault.jpg" loading="lazy">
                            <div class="card-content">
                                <div class="video-eyebrow-date">${new Date(item.pubDate).toLocaleDateString()}</div>
                                <h3 class="video-title">${item.title}</h3>
                            </div>
                            <div class="play-icon">‚ñ∂</div>
                        </div>`;
                    grid.appendChild(card);
                });
            } catch (e) {}
        }

        function switchTab(tabName) {
            document.querySelectorAll('[id^="tab-"]').forEach(t => t.classList.add('hidden'));
            const target = document.getElementById('tab-' + tabName);
            if(target) target.classList.remove('hidden');
            document.querySelectorAll('.segment-btn').forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.getElementById('nav-' + tabName);
            if(activeBtn) { activeBtn.classList.add('active'); updateBubble(activeBtn); }
        }

        function updateBubble(element) {
            const bubble = document.querySelector('.segment-bubble');
            if(element && bubble) {
                bubble.style.width = `${element.offsetWidth}px`;
                bubble.style.left = `${element.offsetLeft}px`;
            }
        }

        window.addEventListener('DOMContentLoaded', () => { fetchYouTubeVideos(); switchTab('videos'); });
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, doc, getDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBq-KX0XbyyMU630BEZb8oRZqdoodPUAzY",
            authDomain: "ikaam-forum.firebaseapp.com",
            projectId: "ikaam-forum",
            storageBucket: "ikaam-forum.firebasestorage.app",
            messagingSenderId: "168313267954",
            appId: "1:168313267954:web:5ec926977e2b658b54d26b",
            measurementId: "G-Q7JNBBE2P8"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let currentTopicId = null;
        let unsubscribeMessages = null;

        // --- AUTH ---
        window.openAuthModal = () => {
            if(currentUser) signOut(auth).then(() => showToast("üëã D√©connect√© !"));
            else document.getElementById('authModal').style.display = 'flex';
        };

        let isLogin = true;
        window.toggleAuthMode = () => {
            isLogin = !isLogin;
            document.getElementById('authTitle').innerText = isLogin ? "Connexion" : "Inscription";
        };

        window.handleAuth = async () => {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            const msg = document.getElementById('authMsg');
            try {
                if(isLogin) await signInWithEmailAndPassword(auth, email, pass);
                else await createUserWithEmailAndPassword(auth, email, pass);
                document.getElementById('authModal').style.display = 'none';
                showToast(isLogin ? "‚úÖ Connect√©" : "‚úÖ Compte cr√©√©");
            } catch(e) { msg.innerText = "Erreur: " + e.code; }
        };

        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            const btn = document.getElementById('authBtn');
            if(user) { btn.innerHTML = `üë§ ${user.email.split('@')[0]}`; btn.style.background = "#e60012"; } 
            else { btn.innerHTML = "üë§ Connexion"; btn.style.background = "#333"; }
        });

        // --- FORUM ---
        window.createNewTopic = async () => {
            if(!currentUser) return alert("‚ùå Connecte-toi pour poster !");
            const titleInput = document.getElementById('newTopicTitle');
            if(!titleInput.value.trim()) return;
            try {
                await addDoc(collection(db, "topics"), {
                    title: titleInput.value.trim(),
                    author: currentUser.email.split('@')[0],
                    userId: currentUser.uid,
                    date: serverTimestamp()
                });
                titleInput.value = "";
            } catch(e) { console.error(e); }
        };

        const q = query(collection(db, "topics"), orderBy("date", "desc"));
        onSnapshot(q, (snapshot) => {
            const container = document.getElementById('topics-container');
            container.innerHTML = "";
            if (snapshot.empty) { container.innerHTML = "<p style='padding:20px; color:gray;'>Aucun sujet.</p>"; return; }
            snapshot.forEach(doc => {
                const data = doc.data();
                const card = document.createElement('div');
                card.className = "card download-card span-full";
                card.style.cursor = "pointer";
                card.onclick = () => openTopic(doc.id, data);
                card.innerHTML = `<div style="display:flex; justify-content:space-between; align-items:center;"><div><div class="video-eyebrow-date" style="color:#0071e3;">${data.author}</div><div class="dl-title" style="font-size:1.2rem; margin-bottom:0;">${data.title}</div></div><div style="font-size:1.5rem; opacity:0.5;">‚ûú</div></div>`;
                container.appendChild(card);
            });
        });

        window.openTopic = (id, data) => {
            currentTopicId = id;
            document.getElementById('forum-list-view').classList.add('hidden');
            document.getElementById('forum-topic-view').classList.remove('hidden');
            document.getElementById('current-topic-header').innerHTML = `<div class="video-eyebrow-date">Sujet de ${data.author}</div><h2 class="dl-title" style="margin-bottom:0;">${data.title}</h2>`;
            
            if(unsubscribeMessages) unsubscribeMessages();
            const qMessages = query(collection(db, `topics/${id}/messages`), orderBy("date", "asc"));
            unsubscribeMessages = onSnapshot(qMessages, (snapshot) => {
                const container = document.getElementById('replies-container');
                container.innerHTML = "";
                snapshot.forEach(doc => {
                    const msg = doc.data();
                    const isMe = currentUser && msg.userId === currentUser.uid;
                    const msgDiv = document.createElement('div');
                    msgDiv.style.alignSelf = isMe ? "flex-end" : "flex-start";
                    msgDiv.style.background = isMe ? "rgba(0, 113, 227, 0.2)" : "var(--glass-bg)";
                    msgDiv.style.border = isMe ? "1px solid #0071e3" : "1px solid var(--glass-border)";
                    msgDiv.style.maxWidth = "80%"; msgDiv.style.padding = "15px"; msgDiv.style.borderRadius = "16px";
                    msgDiv.innerHTML = `<div style="font-size:0.75rem; color:var(--text-secondary); margin-bottom:4px;">${msg.author}</div><div style="color:var(--text-primary); line-height:1.4;">${msg.content}</div>`;
                    container.appendChild(msgDiv);
                });
            });
        };

        window.sendReply = async () => {
            if(!currentUser) return alert("‚ùå Connecte-toi !");
            const input = document.getElementById('replyInput');
            if(!input.value.trim()) return;
            await addDoc(collection(db, `topics/${currentTopicId}/messages`), {
                content: input.value.trim(),
                author: currentUser.email.split('@')[0],
                userId: currentUser.uid,
                date: serverTimestamp()
            });
            input.value = "";
        };

        window.backToForum = () => {
            document.getElementById('forum-topic-view').classList.add('hidden');
            document.getElementById('forum-list-view').classList.remove('hidden');
        };
    </script>
</body>
</html>
